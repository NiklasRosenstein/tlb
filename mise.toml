[tools]
rust = { version = "1.87", profile = "default" }

[tasks.fmt]
run = "cargo fmt --all && mise exec deno -- deno fmt README.md .github/ --line-width 120"

[tasks.fmt-check]
run = "cargo fmt --all -- --check && deno fmt README.md .github/ --line-width 120 --check"

[tasks.lint]
wait_for = ["fmt-check", "fmt"]
run = "cargo clippy --all-features -- -D warnings"

[tasks.fix]
run = "cargo clippy --all-features --fix --allow-dirty --allow-staged"

[tasks.build]
wait_for = ["lint"]
run = "cargo build --all-features"

[tasks.test]
wait_for = ["build"]
run = "cargo test --all-features"

[tasks.ci]
depends = ["fmt-check", "lint", "test", "build"]
